language: python
cache: pip
python:
    - 3.5
    - 3.6
    - 3.7
    - pypy3
    - nightly

before_install:
  - sudo add-apt-repository ppa:openjdk-r/ppa -y
  - sudo apt-get update
  - sudo apt-get install -y openjdk-12-jdk

install:
    - pip install ".[test,devel]"

script:
    - isort --recursive --check --diff crate/ tests/ setup.py
    - flake8 crate/crash
    - coverage run -m unittest -v

after_success:
    - PATH=$PATH:bin/ bin/codecov  # codecov executes coverage which needs to be in $PATH
    - pip install coveralls
    - coveralls

notifications:
    email: false

sudo: false

matrix:
    allow_failures:
        - python: nightly
